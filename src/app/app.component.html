<div class="wrapper">
    <ng-sidebar-container>
        <!-- Preview Panel Side Bar -->
        <ng-sidebar [(opened)]="previewPanel" mode="push" animate="false" sidebarClass="side-bar">
            <div class="pc-tooltip" #tooltip></div>
            <div class="modal" #modal>
                <span class="close" (click)="closePicture()">&times;</span>
                <img class="modal-content" id="img01" #img>
                <div id="caption" #caption></div>
            </div>
            <div class="preview-item" *ngIf="previewItem">
                <button id="close-preview" type="button" class="close" aria-label="Close Preview" (click)="closePreview()">
                    <span>&times;</span>
                </button>
                <!-- <h2 class="preview-title">{{ previewItem.title }} </h2> -->
                <img (click)="openPicture(previewItem.mediaURL, previewItem.description)" class="preview-picture"
                    [src]="previewItem.mediaURL">
                <div *ngFor="let cat of previewItem.categories" class="categories">
                    <span class="badge badge-secondary">{{ cat }}</span>
                </div>
                <p class="preview-metainfo">{{ previewItem.date }} @ {{ previewItem.location }}</p>
                <br>
                <p class="preview-description">{{ previewItem.description }}</p>
                <a [attr.href]="previewItem.externalURL" target="_blank">More information at Indiana University</a>
            </div>
        </ng-sidebar>

        <!-- Page Content -->
        <div ng-sidebar-content class="side-bar-content">
            <div class="canvases">
                <canvas id="webgl-canvas" #webGLCanvas></canvas>
                <div id="css-canvas" #cssCanvas></div>
            </div>

            <app-timeslider 
                *ngIf="dataLoaded" 
                [minDate]="getMinDate()" 
                [maxDate]="getMaxDate()" 
                [width]="60"
                [height]="getWindowInnerHeight()" 
                (onSelect)="filterDataWithTimeSlider($event)">
            </app-timeslider>

            
            <div class="category-legend" *ngIf="dataLoaded">
                <!-- <label>Clickable Legend:</label> -->
                <p [ngStyle]="{ 'color' : categoriesAndColors.get(currentlySelectedCategory) }">
                    Selected: {{ currentlySelectedCategory ? currentlySelectedCategory : 'none' }}
                </p>
                <div class="category-wrapper" *ngIf="showColorCodingLegend">
                    <div *ngFor="let c of categories">
                        <span class="badge badge-secondary" data-toggle="tooltip" data-placement="bottom" [title]="c"
                            (click)="filterDataByCategory(c)"
                            [ngStyle]="{ 'background-color' : categoriesAndColors.get(c) }">&nbsp;</span>
                    </div>
                </div>
                <div class="category-wrapper">
                    <div>
                        <span class="badge badge-secondary" data-toggle="tooltip" data-placement="bottom" title="Clear"
                            (click)="clearCategoryFilter()" style="background-color:#424242; font-size: 12px;">&times;</span>
                    </div>
                </div>
            </div>

            <div class="options btn-group" role="group">
                <button type="button" class="btn  btn-outline-secondary" id="geo-view-button">Geo</button>
                <button type="button" class="btn  btn-outline-secondary" id="set-view-button">Set</button>
                <button type="button" class="btn  btn-outline-secondary" id="net-view-button">Net</button>
                <button type="button" class="btn  btn-outline-secondary" id="stc-view-button">STC</button>
                <button type="button" class="btn  btn-outline-secondary" id="jp-view-button">JP</button>
                <button type="button" class="btn  btn-outline-secondary" id="si-view-button">SI</button>
            </div>

            <div class="overlay" *ngIf="dataLoaded">
                <p>{{ formatDate(currentlySelectedDateExtent[0]) }} - {{ formatDate(currentlySelectedDateExtent[1]) }}</p>
            </div>
        </div>
    </ng-sidebar-container>
   

    <div class="processing-change" *ngIf="processingChange">
        <div class="spinner-border text-info" role="status">
            <span class="sr-only"></span>
        </div>
        <p>{{ processingMessage }}</p>
    </div>

    <div *ngIf="errorOccurred" class="alert alert-danger error">
        <a href="#" class="close" data-dismiss="alert" aria-label="close" (click)="errorOccurred = false">&times;</a>
        <strong>Error</strong>
        <p>{{ errorMessage }}</p>
    </div>
</div>